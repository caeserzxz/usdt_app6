{extend name="mainadmin@layouts/base" /}
{block name="main" }
<style>
    #cp1 .input-group-addon {
        border-radius: 0!important;
        background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgeG1sbnM9Imh0d…0iMSIgaGVpZ2h0PSIxIiBmaWxsPSJ1cmwoI2xlc3NoYXQtZ2VuZXJhdGVkKSIgLz48L3N2Zz4=);
        background-image: -webkit-linear-gradient(top,#eee 0,#fbfbfb 100%);
        background-image: -moz-linear-gradient(top,#eee 0,#fbfbfb 100%);
        background-image: -o-linear-gradient(top,#eee 0,#fbfbfb 100%);
        background-image: linear-gradient(to bottom,#eee 0,#000 100%);
    }
</style>
<header>
    <div class="page-breadcrumbs">
        <ul class="breadcrumb">
            <li>
                <i class="fa fa-ellipsis-v"></i>
                <strong>{$row['id']>0?"编辑图片":"添加图片"}</strong>
            </li>
        </ul>

        <a class="pull-right pointer p-r" data-toggle="back" title="返回"><i class="fa fa-reply"></i></a>
    </div>
</header>

<section class="scrollable  wrapper w-f">
    <form class="form-horizontal form-validate" method="post" action="{:url('info')}" style="padding:0;">
        <section class="panel panel-default">
            <div class="panel-body">
                <div class="form-group">
                    <label class="col-sm-2 control-label">图片</label>
                    <div class="col-sm-6 ">
                        <div id="image_upload" class="">
                            <img class="thumb_img" name="imagefile" src="{$row.imgurl}" style="max-height: 100px;">
                            <input class="hide" name="imgurl" value="{$row.imgurl}" type="text">
                            <button class="btn btn-default" type="button" data-toggle="selectimg">选择图片</button>
                            <span class="">选择上传图片（建议尺寸：750 * 500）</span></div>
                    </div>
                </div>
                <div class="line line-dashed line-lg pull-in"></div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">图片类型</label>
                    <div class="col-sm-2 must">
                        <select id="img_type" name="img_type"  class="input-medium"
                                style="width:200px;">
                            <option value="0">请选择</option>
                            <option value="1" {$row['img_type']|tplckval=1,'selected'}>首页轮播</option>
                            <option value="2" {$row['img_type']|tplckval=2,'selected'}>服务快讯轮播图</option>
                            <option value="3" {$row['img_type']|tplckval=3,'selected'}>叮叮交易所</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">链接类型</label>
                    <div class="col-sm-2 must">
                        <select id="bind_type" name="bind_type" onChange="showUrlType(this,0);" class="input-medium"
                                style="width:200px;">
                            <option>请选择</option>
                            {$WeixinReplyType|raw}
                        </select>
                    </div>
                </div>
<!--                <div class="form-group">-->
<!--                    <label class="col-sm-2 control-label">绑定关联</label>-->
<!--                    <div class="col-sm-4 must">-->
<!--                        <input name="type_val" id="type_val" class="input-xlarge" type="text" value="{$row.data}">-->
<!--&lt;!&ndash;                        <input name="ext_id" id="ext_id" type="hidden" value="{$row.ext_id}">&ndash;&gt;-->
<!--&lt;!&ndash;                        <a href="javascript:;" data-remote="{:url("mainadmin/article/searchBox")}"&ndash;&gt;-->
<!--&lt;!&ndash;                        data-toggle="ajaxModal" class="type_bding_btn btn btn-sm btn-default&ndash;&gt;-->
<!--&lt;!&ndash;                        {$row['bind_type']=='article'?'':'hide'}" id="article_btn" >绑定文章</a>&ndash;&gt;-->
<!--&lt;!&ndash;                        <a href="javascript:;" data-remote="{:url("sys_admin.goods/searchBox")}"&ndash;&gt;-->
<!--&lt;!&ndash;                        data-toggle="ajaxModal" class="type_bding_btn btn btn-sm btn-default&ndash;&gt;-->
<!--&lt;!&ndash;                        {$row['bind_type']=='goods'?'':'hide'}" id="goods_btn" >绑定商品</a>&ndash;&gt;-->
<!--&lt;!&ndash;                        <a href="javascript:;" data-url="{:url('publics/sys_admin.links/index')}"&ndash;&gt;-->
<!--                        &lt;!&ndash;                           data-toggle="iframeModal"&ndash;&gt;-->
<!--                        &lt;!&ndash;                           class="type_bding_btn btn btn-sm btn-default {$row['bind_type']=='link'?'':'hide'}"&ndash;&gt;-->
<!--                        &lt;!&ndash;                           id="link_btn">绑定URL</a>&ndash;&gt;-->
<!--                    </div>-->
<!--                </div>-->
                <div class="form-group">
                    <label class="col-sm-2 control-label">绑定关联</label>
                    <div class="col-sm-4 must">
                        <input name="type_val" id="type_val" class="input-xlarge" type="text" value="{$row.data}">
                        <input name="ext_id" id="ext_id" type="hidden" value="{$row.ext_id}">
                        <a href="javascript:;" data-remote="{:url("mainadmin/article/searchBox")}"
                        data-toggle="ajaxModal" class="type_bding_btn btn btn-sm btn-default
                        {$row['bind_type']=='article'?'':'hide'}" id="article_btn" >绑定文章</a>
                        <a href="javascript:;" data-remote="{:url("sys_admin.goods/searchBox")}"
                        data-toggle="ajaxModal" class="type_bding_btn btn btn-sm btn-default
                        {$row['bind_type']=='goods'?'':'hide'}" id="goods_btn" >绑定商品</a>

                    </div>
                </div>
                <div class="line line-dashed line-lg pull-in"></div>

<!--                <div class="form-group">-->
<!--                    <label class="col-sm-2 control-label">背景颜色：</label>-->
<!--                    <div class="col-sm-2">-->
<!--                            <div id="cp1" class="input-group colorpicker-component" data-color="{$row.bg_color|default='#FFFFFF'}"  title="设置幻灯片背景颜色，默认为白色" style="width: 200px;">-->
<!--                                <input type="text" name="bg_color" class="form-control"/>-->
<!--                                <span class="input-group-addon"><i></i></span>-->
<!--                            </div>-->
<!--                        </div>-->
<!--                </div>-->

                <div class="form-group">
                    <label class="col-sm-2 control-label">是否启用</label>
                    <div class="col-sm-3 ">
                        <label class=" inline">
                            <input type="radio" name="status" value="1" {$row['status']|tplckval=1,'checked',true} />
                            是
                        </label>
                        <label class=" inline">
                            <input type="radio" name="status" value="2" {$row['status']|tplckval=0,'checked'}/>
                            否
                        </label>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">排序</label>
                    <div class="col-sm-3 must">
                        <input type="text" name="sort_order" id="sort_order" value="{$row.sort_order|intval}"
                               data-rule-required="true" data-rule-maxlength="30" class="input-mini">
                        <span style="color:red;">（数字越大越靠前）</span>
                    </div>
                </div>
            </div>
        </section>
</section>
<footer class="footer bg-white b-t p-t">
    <div class="form-group">
        <div class="col-sm-4 col-sm-offset-1">
            <input name="id" type="hidden" value="{$row['id']}"/>
            <button type="submit" class="btn btn-primary js_save_submit" data-loading-text="保存中...">保存</button>
            <button type="button" class="btn btn-default" data-toggle="back">取消</button>
        </div>
    </div>
</footer>
</form>
{/block}
{block name="footer" }
<link rel="stylesheet" type="text/css" href="__STATIC__/js/colorpicker/bootstrap-colorpicker.css">
<script src="__STATIC__/js/colorpicker/bootstrap-colorpicker.js"></script>
<script type="text/javascript">
    seajs.use("dist/plupload/init.js");

    $(function () {
        $('#cp1').colorpicker();
    });

    function showUrlType(sel, input_id) {
        $(".type_bding_btn").addClass('hide');
        $("#type_val").val('');
        $("#ext_id").val(0);
        $("#ext_activity").val(0);
        if (sel.value == 'article') $("#article_btn").removeClass('hide');
        else if (sel.value == 'link') {
            $("#type_val").val('http://');
            $("#link_btn").removeClass('hide');
        }
        else if (sel.value == 'goods') $("#goods_btn").removeClass('hide');
        else if (sel.value == 'activity') $("#activity_btn").removeClass('hide');
    }
    function assigBack(type, type_id, id, title, tid) {
        $("#ext_id").val(id);
        $("#ext_activity").val(tid);
        $("#type_val").val(title);
    }
    var McMore = {
        selectUrlCallback: function (url, type, type_id) {
            $("#type_val").val(url);
            $(".modal-dialog .close").trigger("click");
        }
    }
</script>
{/block}